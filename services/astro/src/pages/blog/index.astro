---
import UserLayout from '@/layouts/UserLayout.astro'

import { postgres } from '@/lib/postgres/index'
import { blog_posts } from '@/lib/postgres/schema'

let array
try {
  array = await postgres.select().from(blog_posts)
} catch (error) {
  // NEEDS FIXING
  console.error(error)
  return Astro.redirect('/500')
}
---

<style>
  @keyframes slideDown {
    0% {
      transform: translateY(-100%);
      opacity: 0;
    }
    100% {
      transform: translateY(0);
      opacity: 1;
    }
  }
  .header-slide-down {
    animation: slideDown 1s ease-out forwards;
  }

  .nav-link {
    display: inline-block;
    transition: transform 0.2s ease;
  }
  .nav-link:hover {
    transform: translateY(-4px);
  }
</style>

<UserLayout>
  <div class="flex flex-col gap-6">
    {
      array.map((blog) => {
        return (
          <a
            href={`/blog/${blog.title}`}
            data-astro-prefetch
            class="text-white h-60 p-4 rounded-md bg-blue-600 shadow-[0_10px_15px_rgba(0,0,0,0.3),0_4px_6px_rgba(0,0,0,0.2)]"
          >
            <section class="line-clamp-7">
              <h1 class="text-lg text-center mb-8">{blog.title}</h1>
              <p>{blog.content_description}</p>
            </section>
          </a>
        )
      })
    }
  </div>
</UserLayout>
